#!/bin/bash
# Postman installer and updater
#

COMMAND=${1:-status}

download() {
	echo "Downloading Postman..."
	wget -q https://dl.pstmn.io/download/latest/linux64 -O /tmp/postman.tar.gz
	tar -xzf /tmp/postman.tar.gz -C /tmp
	rm /tmp/postman.tar.gz

	echo "Moving to opt..."
	if [ -d "/opt/Postman" ]; then
		sudo rm -rf /opt/Postman
	fi
	sudo mv /tmp/Postman /opt/Postman
}

create_synlink() {
	echo "Creating symbolic link..."
	if [ -L "/usr/bin/postman" ]; then
		sudo rm -f /usr/bin/postman
	fi
	sudo ln -s /opt/Postman/Postman /usr/bin/postman
}

create_icon() {
	echo "Creating desktop icon..."
	echo "[Desktop Entry]
Encoding=UTF-8
Name=Postman
Exec=postman
Icon=/opt/Postman/resources/app/assets/icon.png
Terminal=false
Type=Application
Categories=Development;" | sudo tee -a /usr/share/applications/postman.desktop
}

case $COMMAND in
	(install)
		download
		create_synlink
		create_icon
		echo "Postman installed successfully."
	;;
	(update)
		download
		echo "Postman updated successfully."
	;;
	(*)
		echo "Usage: ubuntu-postman {install|update}"
	;;
esac
